AT_INIT
AT_COPYRIGHT([Copyright (C) 2012 by Barry Schwartz])

#--------------------------------------------------------------------------

m4_defun([en_patch_banner],
[
AT_BANNER([  -- The patch tests for en.names-db will be skipped
  -- unless NamesList.txt is in the top build directory.
  -- It must be re-encoded from ISO-8859-1 to UTF-8.])
])

m4_defun([fr_patch_banner],
[
AT_BANNER([  -- The patch tests for fr.names-db will be skipped
  -- unless ListeDesNoms.txt is in the top build directory.])
])

#--------------------------------------------------------------------------

AT_BANNER([C tests])

AT_SETUP([C create/delete uninameslookup: en.names-db])
AT_CHECK(["${builddir}"/c_create_delete_uninameslookup "${abs_top_srcdir}/en.names-db"],
         [0],[ignore],[ignore])
AT_CLEANUP

AT_SETUP([C create/delete uninameslookup: fr.names-db])
AT_CHECK(["${builddir}"/c_create_delete_uninameslookup "${abs_top_srcdir}/fr.names-db"],
         [0],[ignore],[ignore])
AT_CLEANUP

AT_SETUP([C open missing uninameslookup])
AT_CHECK(["${builddir}"/c_create_delete_uninameslookup "------------i-do-not-exist------------"],
         [1],[ignore],[ignore])
AT_CLEANUP

AT_SETUP([C open corrupted uninameslookup])
AT_CHECK(["${builddir}"/c_create_delete_uninameslookup  "${abs_top_builddir}/Makefile"],
         [1],[ignore],[ignore])
AT_CLEANUP

en_patch_banner
AT_SETUP([C patch test: en.names-db])
AT_SKIP_IF([test ! -f "${abs_top_builddir}/NamesList.txt"])
AT_CHECK(["${builddir}"/c_patch_test "${abs_top_srcdir}/en.names-db" "${abs_top_builddir}/NamesList.txt"],
         [0],[ignore],[ignore])
AT_CLEANUP

fr_patch_banner
AT_SETUP([C patch test: fr.names-db])
AT_SKIP_IF([test ! -f "${abs_top_builddir}/ListeDesNoms.txt"])
AT_CHECK(["${builddir}"/c_patch_test "${abs_top_srcdir}/fr.names-db" "${abs_top_builddir}/ListeDesNoms.txt"],
         [0],[ignore],[ignore])
AT_CLEANUP

#--------------------------------------------------------------------------

AT_BANNER([C++ tests])

AT_SETUP([C++ create/delete uninameslookup: en.names-db])
AT_CHECK(["${builddir}"/cxx_create_delete_uninameslookup "${abs_top_srcdir}/en.names-db"],
         [0],[ignore],[ignore])
AT_CLEANUP

AT_SETUP([C++ create/delete uninameslookup: fr.names-db])
AT_CHECK(["${builddir}"/cxx_create_delete_uninameslookup "${abs_top_srcdir}/fr.names-db"],
         [0],[ignore],[ignore])
AT_CLEANUP

AT_SETUP([C++ open missing uninameslookup])
AT_CHECK(["${builddir}"/cxx_create_delete_uninameslookup "------------i-do-not-exist------------"],
         [1],[ignore],[ignore])
AT_CLEANUP

AT_SETUP([C++ open corrupted uninameslookup])
AT_CHECK(["${builddir}"/cxx_create_delete_uninameslookup  "${abs_top_builddir}/Makefile"],
         [1],[ignore],[ignore])
AT_CLEANUP

en_patch_banner
AT_SETUP([C++ patch test: en.names-db])
AT_SKIP_IF([test ! -f "${abs_top_builddir}/NamesList.txt"])
AT_CHECK(["${builddir}"/cxx_patch_test "${abs_top_srcdir}/en.names-db" "${abs_top_builddir}/NamesList.txt"],
         [0],[ignore],[ignore])
AT_CLEANUP

fr_patch_banner
AT_SETUP([C++ patch test: fr.names-db])
AT_SKIP_IF([test ! -f "${abs_top_builddir}/ListeDesNoms.txt"])
AT_CHECK(["${builddir}"/cxx_patch_test "${abs_top_srcdir}/fr.names-db" "${abs_top_builddir}/ListeDesNoms.txt"],
         [0],[ignore],[ignore])
AT_CLEANUP

#--------------------------------------------------------------------------

AT_BANNER([Python tests])

AT_SETUP([Python import uninameslookup])
AT_SKIP_IF([${skip_python}])
AT_CHECK([${PYTHON} "${srcdir}"/import_uninameslookup.py],[0],[ignore],[ignore])
AT_CLEANUP

AT_SETUP([Python create/delete uninameslookup: en.names-db])
AT_SKIP_IF([${skip_python}])
AT_CHECK([${PYTHON} "${srcdir}"/create_delete_uninameslookup.py "${abs_top_srcdir}/en.names-db"],
         [0],[ignore],[ignore])
AT_CLEANUP

AT_SETUP([Python create/delete uninameslookup: fr.names-db])
AT_SKIP_IF([${skip_python}])
AT_CHECK([${PYTHON} "${srcdir}"/create_delete_uninameslookup.py "${abs_top_srcdir}/fr.names-db"],
         [0],[ignore],[ignore])
AT_CLEANUP

AT_SETUP([Python open missing uninameslookup])
AT_SKIP_IF([${skip_python}])
AT_CHECK([${PYTHON} "${srcdir}"/create_delete_uninameslookup.py "------------i-do-not-exist------------"],
         [1],[ignore],[ignore])
AT_CLEANUP

AT_SETUP([Python open corrupted uninameslookup])
AT_SKIP_IF([${skip_python}])
AT_CHECK([${PYTHON} "${srcdir}"/create_delete_uninameslookup.py "${abs_top_builddir}/Makefile"],
         [1],[ignore],[ignore])
AT_CLEANUP

en_patch_banner
AT_SETUP([Python patch test: en.names-db])
AT_SKIP_IF([${skip_python}])
AT_SKIP_IF([test ! -f "${abs_top_builddir}/NamesList.txt"])
AT_CHECK([${PYTHON} "${srcdir}"/patch_test.py "${abs_top_srcdir}/en.names-db" "${abs_top_builddir}/NamesList.txt" 100000],
         [0],[ignore],[ignore])
AT_CLEANUP

fr_patch_banner
AT_SETUP([Python patch test: fr.names-db])
AT_SKIP_IF([${skip_python}])
AT_SKIP_IF([test ! -f "${abs_top_builddir}/ListeDesNoms.txt"])
AT_CHECK([${PYTHON} "${srcdir}"/patch_test.py "${abs_top_srcdir}/fr.names-db" "${abs_top_builddir}/ListeDesNoms.txt" 100000],
         [0],[ignore],[ignore])
AT_CLEANUP

#--------------------------------------------------------------------------
